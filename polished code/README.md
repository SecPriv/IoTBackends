The following folder contains all the code used throughout the project organized by folder. Before running any scripts, install the pip requirements as for the [requirements.txt](requirements.txt) file. Further, for XMPP analysis, `nmap` is required.

The directories are structured as follows:

1. [shodan-crawl](shodan-crawl) contains all the scripts we used to gather our initial dataset of 425,571 MQTT, 474,878 CoAP, 4 CoAPs, and 702 XMPP backends. Note that the datasets are not publicly available. Please, drop us an email in case you are interested in accessing them. To perform the queries, a Shodan API key is necesssary (see https://developer.shodan.io/api/requirements)
2. [dataset-analysis](dataset-analysis) contains the scripts and data we used to enrich our dataset. Particularly, we report the IP ranges of the top ten cloud hosting providers in [dataset-analysis/ip-ranges-cloud-providers](dataset-analysis/ip-ranges-cloud-providers). The two scripts, [general_analysis.py](dataset-analysis/general_analysis.py) and [add_missing_providers.py](dataset-analysis/add_missing_providers.py) are to be executed in order and serve to add the providers to Shodan's results. The [country_analysis.py](dataset-analysis/country_analysis.py) script simply gets the backends' country distribution.
3. [large-scale-security-assessment](large-scale-security-assessment) contains the main scripts used for our security analysis and for the evaluation of results. For more detailed information, refer to the README within the folder.
4. [tls-analysis](tls-analysis) contains the scripts of our TLS analysis on the backends. Again, more detail within the folder.
